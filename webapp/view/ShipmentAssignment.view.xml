<mvc:View
    controllerName="com.sut.bolgeyonetim.controller.ShipmentAssignment"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
>
    <Page
        title="Yükleme Planlaması"
        showNavButton="true"
        navButtonPress="onNavBack"
    >
        <content>
            <!-- Search Field -->
            <SearchField
                id="idSearchField"
                placeholder="Plasiyer veya nakliye no ile ara..."
                liveChange="onSearch"
                width="75%"
                class="sapUiSmallMarginBottom sapUiSmallMarginBegin sapUiSmallMarginEnd"
            />

            <!-- Type Filter - Main IconTabBar -->
            <IconTabBar
                id="idTypeFilterBar"
                select="onTypeFilterSelect"
                class="sapUiResponsiveContentPadding"
                upperCase="false"
                stretchContentHeight="false"
                expandable="false"
            >
                <items>
                    <IconTabFilter
                        id="idMonoTab"
                        key="MONO"
                        text="Monodistribütör"
                        count="{shipmentStatsModel>/monoCount}"
                        icon="sap-icon://supplier"
                    />
                    <IconTabFilter
                        id="idOrganizeTab"
                        key="ORGANIZE"
                        text="Organize Dağıtım"
                        count="{shipmentStatsModel>/organizeCount}"
                        icon="sap-icon://tree"
                    />
                </items>
            </IconTabBar>

            <!-- Assignment Status Filter - Sub IconTabBar -->
            <IconTabBar
                id="idAssignmentFilterBar"
                select="onAssignmentFilterSelect"
                class="sapUiTinyMarginTop"
                upperCase="false"
                stretchContentHeight="false"
                expandable="false"
            >
                <items>
                    <IconTabFilter
                        id="idAllTab"
                        key="all"
                        text="Tümü"
                        count="{shipmentStatsModel>/currentTypeAllCount}"
                    />
                    <IconTabFilter
                        id="idPendingAssignTab"
                        key="pending"
                        text="Bekleyen"
                        count="{shipmentStatsModel>/currentTypePendingCount}"
                    />
                    <IconTabFilter
                        id="idAssignedTab"
                        key="assigned"
                        text="Atanan"
                        count="{shipmentStatsModel>/currentTypeAssignedCount}"
                    />
                </items>
            </IconTabBar>

            <!-- Shipments List -->
            <List
                id="idShipmentList"
                items="{shipmentModel>/}"
                growing="true"
                growingThreshold="20"
                growingScrollToLoad="true"
                noDataText="Yükleme kaydı bulunamadı"
            >
                <items>
                    <CustomListItem type="Inactive">
                        <VBox
                            width="100%"
                            class="sapUiSmallMargin"
                        >
                            <!-- Card-like container with colored border -->
                            <HBox
                                alignItems="Start"
                                justifyContent="SpaceBetween"
                                width="100%"
                                class="{= (${shipmentModel>SelectedOfficerKeys}.length === 0 &amp;&amp; ${shipmentModel>SelectedEmployeeKeys}.length === 0) ? 'sapUiSmallPadding shipmentCard shipmentCardPending' : 'sapUiSmallPadding shipmentCard shipmentCardAssigned' }"
                            >
                                <!-- Left Side: Shipment Info -->
                                <VBox
                                    width="45%"
                                    class="sapUiTinyMarginEnd"
                                >
                                    <!-- Icon and Shipment ID -->
                                    <HBox
                                        alignItems="Center"
                                        class="sapUiTinyMarginBottom"
                                    >
                                        <core:Icon
                                            src="sap-icon://shipping-status"
                                            size="2rem"
                                            color="{= (${shipmentModel>SelectedOfficerKeys}.length === 0 &amp;&amp; ${shipmentModel>SelectedEmployeeKeys}.length === 0) ? '#e9730c' : '#0854A0' }"
                                            class="sapUiSmallMarginEnd"
                                        />
                                        <VBox>
                                            <Label
                                                text="{
                                                path: 'shipmentModel>ShipmentId',
                                                formatter: '.formatShipmentId'
                                            }"
                                                design="Bold"
                                            />
                                            <Label
                                                text="{
                                                path: 'shipmentModel>ShipmentDate',
                                                formatter: '.formatDate'
                                            }"
                                                class="sapUiTinyMarginTop"
                                            />
                                        </VBox>
                                    </HBox>
                                    <Label
                                        text="{shipmentModel>CustomerName}"
                                        class="sapUiTinyMarginTop"
                                    />
                                </VBox>

                                <!-- Right Side: Personnel Assignment -->
                                <VBox width="50%">
                                    <Label
                                        text="Atanan Memur (Max: 1)"
                                        design="Bold"
                                        class="sapUiTinyMarginTop sapUiTinyMarginBottom"
                                    />
                                    <Button
                                        text="{= ${shipmentModel>SelectedOfficerKeys}.length > 0 ? ${shipmentModel>SelectedOfficerKeys}.length + ' Memur Seçildi' : 'Memur Seç'}"
                                        icon="sap-icon://employee"
                                        press="onOpenOfficerDialog"
                                        width="75%"
                                        type="{= ${shipmentModel>SelectedOfficerKeys}.length > 0 ? 'Accept' : 'Emphasized' }"
                                    />
                                    <Label
                                        text="Atanan Personel (Max: 5)"
                                        design="Bold"
                                        class="sapUiTinyMarginBottom"
                                    />
                                    <Button
                                        text="{= ${shipmentModel>SelectedEmployeeKeys}.length > 0 ? ${shipmentModel>SelectedEmployeeKeys}.length + ' Personel Seçildi' : 'Personel Seç'}"
                                        icon="sap-icon://employee"
                                        press="onOpenPersonnelDialog"
                                        width="75%"
                                        type="{= ${shipmentModel>SelectedEmployeeKeys}.length > 0 ? 'Accept' : 'Emphasized' }"
                                        class="sapUiTinyMarginBottom"
                                    />
                                </VBox>
                            </HBox>
                        </VBox>
                    </CustomListItem>
                </items>
            </List>
        </content>
    </Page>
</mvc:View>
