<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core">
    <Dialog
        title="Miktar Düzenleme"
        contentWidth="550px"
        draggable="true"
        resizable="false"
        class="sapUiSizeCompact">
        <content>
            <VBox class="sapUiSmallMargin">
                <!-- Header: Ürün Bilgisi -->
                <VBox class="sapUiSmallMarginBottom">
                    <Title text="{smartCountModel>/materialText}" level="H4" class="sapUiTinyMarginBottom"/>
                    
                    <HBox justifyContent="SpaceBetween" alignItems="Center">
                        <Label text="Beklenen: {smartCountModel>/expectedQuantity} {smartCountModel>/uom}" design="Bold"/>
                        <!-- Hepsini Al Linki -->
                        <Link emphasized="true" text="Hepsini Al" press="onCopyExpectedToReceived"/>
                    </HBox>
                </VBox>

                <!-- Divider -->
                <core:HTML content='&lt;div style=&quot;border-top:1px solid #e5e5e5; margin: 0.5rem 0 1rem 0;&quot;&gt;&lt;/div&gt;' />

                <!-- Input Area: Yatay Hizalama -->
                <HBox justifyContent="SpaceBetween" alignItems="Start">
                    <!-- 1. Ana Miktar (Manuel Giriş) -->
                    <VBox width="30%">
                        <Label text="Miktar" design="Bold" required="true" class="sapUiTinyMarginBottom"/>
                      <StepInput
                            value="{smartCountModel>/totalCalculated}"
                            min="0"
                            step="1"
                            displayValuePrecision="2"
                            textAlign="Center"
                            change="onTotalManualChange"
                            valueState="{= ${smartCountModel>/quantityErrorState} ? 'Error' : 'None' }"
                            valueStateText="Beklenen miktardan fazla giremezsiniz"/> 
                    </VBox>

                    <!-- 2. Palet -->
                    <VBox width="30%">
                        <Label text="Palet ({smartCountModel>/palletFactor})" design="Bold" class="sapUiTinyMarginBottom"/>
                        <StepInput
                            value="{smartCountModel>/palletCount}"
                            min="0"
                            step="1"
                            displayValuePrecision="2" 
                            textAlign="Center"
                            change="onSmartInputChanged"/>
                    </VBox>

                    <!-- 3. Sepet -->
                    <VBox width="30%">
                        <Label text="Sepet ({smartCountModel>/crateFactor})" design="Bold" class="sapUiTinyMarginBottom"/>
                        <StepInput
                            value="{smartCountModel>/crateCount}"
                            min="0"
                            step="1"
                            displayValuePrecision="2" 
                            textAlign="Center"
                            change="onSmartInputChanged"/>
                    </VBox>
                </HBox>
                
                <!-- Footer: Fark Nedeni -->
                <VBox visible="{smartCountModel>/showReasonError}" class="sapUiMediumMarginTop">
                    <Label text="* Düzenleme Nedeni" required="true" design="Bold" class="sapUiTinyMarginBottom"/>
                    <ComboBox
                        id="idSmartReasonComboGI"
                        selectedKey="{smartCountModel>/editReason}"
                        width="100%"
                        placeholder="Neden seçin"
                        valueState="{= ${smartCountModel>/reasonErrorState} ? 'Error' : 'None' }"
                        valueStateText="İşlemi bitirmek için neden belirtmelisiniz"
                        items="{editReasonsModel>/}">
                        <core:Item key="{editReasonsModel>Key}" text="{editReasonsModel>Text}"/>
                    </ComboBox>
                </VBox>
            </VBox>
        </content>
        <buttons>
            <Button
                text="Kaydet"
                icon="sap-icon://save"
                type="Emphasized"
                press="onSmartSaveIntermediateGI"/>
            <Button
                text="İptal"
                type="Transparent"
                press="onSmartDialogCancel"/>
        </buttons>
    </Dialog>
</core:FragmentDefinition>
